#!/usr/bin/env bash

# Author of changes: trimstray (contact@nslab.at, https://github.com/trimstray)
#   - removed blank spaces/tabs
#   - correcting indentation (transparent code)
#   - replaced 'test' to '[[ ]]'
#   - changed comparison operator (-eq)
#   - protection against giving an illegal value
function malware () {

  clear
  echo
  echo

  echo -e $white"     ID                    DESCRIPTION"
  echo -e $white"    ---------------------------------------------------------"
  echo -e $white"    [$okegreen"01"$white]$cyan auth-spoof "
  echo -e $white"    [$okegreen"02"$white]$cyan dns-zeustracker  "
  echo -e $white"    [$okegreen"03"$white]$cyan ftp-proftpd-backdoor "
  echo -e $white"    [$okegreen"04"$white]$cyan ftp-vsftpd-backdoor  "
  echo -e $white"    [$okegreen"05"$white]$cyan http-google-malware  "
  echo -e $white"    [$okegreen"06"$white]$cyan http-malware-host  "
  echo -e $white"    [$okegreen"07"$white]$cyan http-virustotal  "
  echo -e $white"    [$okegreen"08"$white]$cyan irc-unrealircd-backdoor  "
  echo -e $white"    [$okegreen"09"$white]$cyan smtp-strangeport "
  echo -e $white"    [$okegreen"10"$white]$cyan back "
  echo

  echo -n -e $red'  \033[4mScreetsec@nse-malware:\033[0m>> '; tput sgr0 #insert your choice
  read malw

  if [[ $malw -eq 1 ]] ; then

    echo
    echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
    read ip
    $xterm -sV --script=auth-spoof $ip &

  elif [[ $malw -eq 2 ]] ; then

    echo
    echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
    read ip
    $xterm  -sn -PN --script=dns-zeustracker $ip &

  elif [[ $malw -eq 3 ]] ; then

    echo
    echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
    read ip
    $xterm --script ftp-proftpd-backdoor -p 21 $ip &

  elif [[ $malw -eq 4 ]] ; then

    echo
    echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
    read ip
    $xterm  --script ftp-vsftpd-backdoor -p 21 $ip &

  elif [[ $malw -eq 5 ]] ; then

    echo
    echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
    read ip
    $xterm -p80 --script http-google-malware $ip &

  elif [[ $malw -eq 6 ]] ; then

    echo
    echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
    read ip
    $xterm  -sV --script=http-malware-host $ip &

  elif [[ $malw -eq 7 ]] ; then

    echo
    echo -ne $okegreen " an API key acquired from the virustotal web page: " ; tput sgr0
    read key
    echo -ne $okegreen " a SHA1, SHA256, MD5 checksum of a file to check: " ; tput sgr0
    read sum
    $xterm --script http-virustotal --script-args="http-virustotal.apikey="$key",http-virustotal.checksum="$sum"" &

  elif [[ $malw -eq 8 ]] ; then

    echo
    echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
    read ip
    $xterm-sV --script=irc-unrealircd-backdoor $ip &

  elif [[ $malw -eq 9 ]] ; then

    echo
    echo -ne $okegreen " What is your IP Target or Host: " ; tput sgr0
    read ip
    $xterm -sV --script=smtp-strangeport $ip &

  elif [[ $malw -eq 10 ]] ; then

    nse

  else

    echo ""
    echo -e $okegreen " Incorrect Number"

  fi

  echo ""
  echo ""
  echo -n -e $red " Back to Last Menu? ( Yes / No ) :"
  read back

  if [ $back != 'n' ] && \
     [ $back != 'N' ] && \
     [ $back != 'no' ] && \
     [ $back != 'No' ] ; then

    clear
    menu

  elif [ $back != 'y' ] && \
       [ $back != 'Y' ] && \
       [ $back != 'yes' ] && \
       [ $back != 'Yes' ] ; then

    malware

  else

    clear
    malware

  fi

}
